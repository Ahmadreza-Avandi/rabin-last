# راهنمای ایمپورت اکسل

این راهنما نحوه استفاده از قابلیت ایمپورت اکسل در سیستم CRM را توضیح می‌دهد.

## فایل‌های نمونه

دو فایل نمونه برای ایمپورت آماده شده است:

### 1. فایل نمونه مشتریان (Customers)
📁 **مسیر:** `public/sample-customers.csv`
🔗 **دانلود:** http://localhost:3000/sample-customers.csv

**ستون‌های موجود:**
- نام شرکت ⭐ (الزامی)
- ایمیل
- تلفن
- وبسایت
- صنعت
- اندازه شرکت (small, medium, large)
- وضعیت (active, inactive, blocked)
- شهر
- استان
- کشور
- آدرس
- تعداد کارمندان
- درآمد سالیانه
- اولویت (low, medium, high)
- یادداشت

### 2. فایل نمونه مخاطبین (Contacts)
📁 **مسیر:** `public/sample-contacts.csv`
🔗 **دانلود:** http://localhost:3000/sample-contacts.csv

**ستون‌های موجود:**
- نام ⭐ (الزامی)
- نام خانوادگی ⭐ (الزامی)
- ایمیل
- تلفن
- موبایل
- عنوان شغلی
- دپارتمان
- شرکت
- شهر
- یادداشت

## نحوه استفاده

### مرحله 1: دانلود فایل نمونه
1. به صفحه مورد نظر بروید:
   - مشتریان: http://localhost:3000/dashboard/customers
   - مخاطبین: http://localhost:3000/dashboard/contacts

2. روی دکمه **"ایمپورت از اکسل"** کلیک کنید

3. در پنجره باز شده، روی **"دانلود فایل نمونه"** کلیک کنید

### مرحله 2: آماده‌سازی داده‌ها
1. فایل نمونه را باز کنید (با Excel، LibreOffice یا Google Sheets)

2. داده‌های خود را وارد کنید:
   - می‌توانید ستون‌ها را تغییر دهید
   - می‌توانید ستون‌های اضافی حذف کنید
   - فقط فیلدهای الزامی (⭐) را حتماً پر کنید

3. فایل را ذخیره کنید (فرمت‌های پشتیبانی شده: `.xlsx`, `.xls`, `.csv`)

### مرحله 3: آپلود و نقشه‌برداری
1. روی دکمه **"ایمپورت از اکسل"** کلیک کنید

2. فایل خود را انتخاب کنید یا بکشید و رها کنید

3. سیستم به صورت خودکار ستون‌های فایل شما را با فیلدهای سیستم تطبیق می‌دهد

4. در صورت نیاز، نقشه‌برداری را دستی تنظیم کنید:
   - هر فیلد سیستم را با یک ستون از فایل اکسل مطابقت دهید
   - فیلدهای الزامی باید حتماً نقشه‌برداری شوند

5. روی **"شروع ایمپورت"** کلیک کنید

### مرحله 4: بررسی نتایج
پس از اتمام ایمپورت، نتایج نمایش داده می‌شود:
- ✅ تعداد رکوردهای موفق
- ❌ تعداد رکوردهای ناموفق
- 📊 کل رکوردها
- 📝 لیست خطاها (در صورت وجود)

## نکات مهم

### فرمت داده‌ها
- **تاریخ:** از فرمت شمسی استفاده کنید (مثال: 1402/12/15)
- **شماره تلفن:** با کد کشور یا بدون آن (مثال: 02188776655 یا 09121234567)
- **ایمیل:** فرمت معتبر ایمیل (مثال: info@example.com)
- **وضعیت:** فقط مقادیر مجاز (active, inactive, blocked)
- **اولویت:** فقط مقادیر مجاز (low, medium, high)
- **اندازه شرکت:** فقط مقادیر مجاز (small, medium, large)

### محدودیت‌ها
- حداکثر حجم فایل: 10 مگابایت
- حداکثر تعداد رکورد در هر بار: 1000 ردیف
- فرمت‌های پشتیبانی شده: Excel (.xlsx, .xls) و CSV (.csv)

### رفع مشکلات رایج

**مشکل:** فایل آپلود نمی‌شود
- ✅ بررسی کنید فرمت فایل صحیح باشد
- ✅ حجم فایل کمتر از 10 مگابایت باشد
- ✅ فایل خراب نباشد

**مشکل:** خطای "فیلدهای الزامی نقشه‌برداری نشده‌اند"
- ✅ مطمئن شوید تمام فیلدهای الزامی (⭐) نقشه‌برداری شده‌اند
- ✅ ستون‌های فایل اکسل با فیلدهای سیستم مطابقت داشته باشند

**مشکل:** برخی رکوردها ایمپورت نمی‌شوند
- ✅ بررسی کنید داده‌ها فرمت صحیح داشته باشند
- ✅ فیلدهای الزامی در تمام ردیف‌ها پر شده باشند
- ✅ مقادیر وارد شده معتبر باشند (مثلاً ایمیل صحیح، شماره تلفن معتبر)

## مثال‌های عملی

### مثال 1: ایمپورت 10 مشتری جدید
```
1. فایل sample-customers.csv را دانلود کنید
2. 10 ردیف داده مشتری را وارد کنید
3. فایل را ذخیره کنید
4. از طریق صفحه Customers آپلود کنید
5. نقشه‌برداری را بررسی و تایید کنید
6. ایمپورت را شروع کنید
```

### مثال 2: ایمپورت مخاطبین از فایل موجود
```
1. فایل Excel موجود خود را باز کنید
2. ستون‌ها را با فرمت نمونه تطبیق دهید
3. فایل را با فرمت .xlsx ذخیره کنید
4. از طریق صفحه Contacts آپلود کنید
5. نقشه‌برداری خودکار را بررسی کنید
6. در صورت نیاز، تنظیمات دستی انجام دهید
7. ایمپورت را شروع کنید
```

## پشتیبانی

در صورت بروز مشکل یا سوال:
- 📧 ایمیل: support@example.com
- 📞 تلفن: 021-12345678
- 💬 چت آنلاین: از طریق سیستم

---

**نسخه:** 1.0.0  
**آخرین بروزرسانی:** 1403/10/15
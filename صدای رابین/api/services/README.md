# ๐๏ธ Database Integration Layer

ุงู ูุงู ุจุฑุง ุชุดุฎุต ฺฉููุงุช ฺฉูุฏ ุฏุฑ ูุชู ฺฉุงุฑุจุฑ ู ุฏุฑุงูุช ุงุทูุงุนุงุช ูุฑุชุจุท ุงุฒ ุฏุชุงุจุณ ุทุฑุงุญ ุดุฏู.

## ๐ ุฌุฑุงู ฺฉุงุฑ

```
ฺฉุงุฑุจุฑ ุตุญุจุช ูโฺฉูู
       โ
Web Speech API (ุชุดุฎุต ฺฏูุชุงุฑ)
       โ
๐ Keyword Detection & Database Query โ ุงู ูุงู ุฌุฏุฏ
       โ
ูุชู + ุฏุงุฏูโูุง ุฏุชุงุจุณ ุจู AI ุงุฑุณุงู ูโุดู
       โ
OpenRouter (Claude) ูพุงุณุฎ ุชููุฏ ูโฺฉูู
       โ
ูพุงุณุฎ ุจู TTS API ุงุฑุณุงู ูโุดู
```

## ๐ ูุงูโูุง ุงู ูุงู

### `database.js`
- ุงุชุตุงู ุจู MySQL ุฏุชุงุจุณ
- ุชูุงุจุน ุฏุฑุงูุช ุงุทูุงุนุงุช (ููฺฉุงุฑุงูุ ูุดุชุฑุงูุ ูุฑูุดุ ูุธุงูุ ูพุฑูฺูโูุง)
- Connection pooling ุจุฑุง ุจูุชุฑ ุจูุฏู performance

### `keywordDetector.js`
- ุชุดุฎุต ฺฉููุงุช ฺฉูุฏ ุฏุฑ ูุชู ูุงุฑุณ
- ูฺฏุงุดุช ฺฉููุงุช ุจู ุนููฺฉุฑุฏูุง ุฏุชุงุจุณ
- ูพุฑุฏุงุฒุด ู ูุฑูุช ฺฉุฑุฏู ูุชุงุฌ

### `dataEnrichment.js` (Middleware)
- ุบูโุณุงุฒ ูพุงู ฺฉุงุฑุจุฑ ุจุง ุฏุงุฏูโูุง ุฏุชุงุจุณ
- ุงุถุงูู ฺฉุฑุฏู context ุจู ูพุงู ุจุฑุง AI
- ูุฏุฑุช ุฎุทุงูุง ุจุฏูู ุฎุฑุงุจ ฺฉุฑุฏู ุณุณุชู

## ๐ ฺฉููุงุช ฺฉูุฏ ูพุดุชุจุงู ุดุฏู

### ฺฉุงุฑุจุฑุงู ู ููฺฉุงุฑุงู
- ููฺฉุงุฑุงูุ ููฺฉุงุฑุ ฺฉุงุฑููุฏุงูุ ฺฉุงุฑููุฏุ ูพุฑุณููุ ุชูุ ฺฉุงุฑุจุฑุงูุ ฺฉุงุฑุจุฑ

### ูุดุชุฑุงู  
- ูุดุชุฑุงูุ ูุดุชุฑุ ฺฉูุงูุชุ ุฎุฑุฏุงุฑุ ูุฑุงุฌุน

### ูุฑูุด ู ูุนุงููุงุช
- ูุฑูุดุ ูุฑูุดุงุชุ ุฏุฑุขูุฏุ ูุนุงููุงุชุ ูุนุงูููุ ุณูุงุฑุดุ ุณูุงุฑุดุงุช
- + ฺฉููุงุช ุฒูุงู: ุงูุฑูุฒุ ููุชูุ ูุงู

### ูุนุงูุชโูุง ู ูุธุงู
- ูุนุงูุชุ ูุนุงูุชโูุงุ ูุธุงูุ ูุธููุ ุชุณฺฉุ ุชุณฺฉโูุงุ ฺฉุงุฑุ ฺฉุงุฑูุง
- + ูุงู ููฺฉุงุฑุงู: ุงุญูุฏุ ุงุญูุฏุฑุถุงุ ุนูุ ุณุงุฑุงุ ูุญูุฏุ ุขููุฏุ ฺฉุฑู

### ูุนุงููุงุช (ูพุฑูฺูโูุง)
- ูพุฑูฺูุ ูพุฑูฺูโูุงุ ูพุฑูฺู ูุงุ ูพุฑฺู

### ฺฏุฒุงุฑุดุงุช ุฑูุฒุงูู
- ฺฏุฒุงุฑุดุ ฺฏุฒุงุฑุดุงุชุ ฺฏุฒุงุฑุด ุฑูุฒุงููุ ฺฏุฒุงุฑุดุงุช ุฑูุฒุงูู

### ุจุงุฒุฎูุฑุฏูุง ู ูุธุฑุงุช
- ุจุงุฒุฎูุฑุฏุ ุจุงุฒุฎูุฑุฏูุงุ ูุธุฑุงุชุ ูุธุฑุ ุฑุถุงุช

### ุฑูุฏุงุฏูุง ู ุชููู
- ุฑูุฏุงุฏุ ุฑูุฏุงุฏูุงุ ุฌูุณูุ ุฌูุณุงุชุ ุชูููุ ูุฑุงุฑ

### ุงุณูุงุฏ ู ูุฏุงุฑฺฉ
- ุณูุฏุ ุงุณูุงุฏุ ูุฏุฑฺฉุ ูุฏุงุฑฺฉุ ูุงูุ ูุงูโูุง

## ๐๏ธ ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

```bash
# ูุตุจ dependency ุฌุฏุฏ
npm install mysql2

# ุชุณุช ุงุชุตุงู ุฏุชุงุจุณ
node api/test/testDatabase.js
```

## โ๏ธ ุชูุธูุงุช ุฏุชุงุจุณ

```javascript
const DB_CONFIG = {
  host: "181.41.194.136",
  database: "crm_system", 
  user: "crm_app_user",
  password: "Ahmad.1386"
};
```

## ๐ ููููู ุงุณุชูุงุฏู

```javascript
// ุฏุฑ AI route
router.post('/process', enrichUserMessage, async (req, res) => {
  const { userMessage, enrichedMessage, hasSystemData } = req.body;
  
  // ุงฺฏุฑ ุฏุงุฏูโูุง ุณุณุชู ููุฌูุฏ ุจุงุดุฏุ ุงุฒ enrichedMessage ุงุณุชูุงุฏู ฺฉู
  const messageToAI = hasSystemData ? enrichedMessage : userMessage;
});
```

## ๐ ูุซุงูโูุง ฺฉุงุฑุจุฑุฏ

### ูุฑูุฏ ฺฉุงุฑุจุฑ:
"ูุณุช ููฺฉุงุฑุงู ูุนุงู ุฑู ูุดูู ุจุฏู"

### ุฎุฑูุฌ ุณุณุชู:
```
ูุณุช ููฺฉุงุฑุงู ูุนุงู ุฑู ูุดูู ุจุฏู

[ุงุทูุงุนุงุช ุณุณุชู: 
๐ ุฏุฑุงูุช ุงุทูุงุนุงุช ููฺฉุงุฑุงู:
- ุชุนุฏุงุฏ ููฺฉุงุฑุงู ูุนุงู: 15
- ููููู: ุงุญูุฏ ุฑุถุงุ ุนู ูุญูุฏุ ุณุงุฑุง ุงุญูุฏ
]
```

## ๐ก๏ธ ูุฏุฑุช ุฎุทุง

- ุงฺฏุฑ ุฏุชุงุจุณ ุฏุฑ ุฏุณุชุฑุณ ูุจุงุดุฏุ ุณุณุชู ุจุฏูู ุฏุงุฏู ุงุฏุงูู ูโุฏู
- ุฎุทุงูุง SQL ูุงฺฏ ูโุดู ูู ุณุณุชู ุฑู ุฎุฑุงุจ ููโฺฉูู
- Timeout ุจุฑุง ุฌููฺฏุฑ ุงุฒ hang ุดุฏู

## ๐ ุจูุจูุฏูุง ุขูุฏู

- [ ] Cache ฺฉุฑุฏู ูุชุงุฌ ุฏุชุงุจุณ
- [ ] ูพุดุชุจุงู ุงุฒ ฺฉููุงุช ฺฉูุฏ ุจุดุชุฑ
- [ ] ุชุดุฎุต ูุงูโูุง ุดุฎุต ุจูุชุฑ
- [ ] ฺฏุฒุงุฑุดโูุง ูพุดุฑูุชูโุชุฑ
- [ ] Real-time data updates
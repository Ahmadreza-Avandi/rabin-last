# ğŸ¤– Ù¾Ø±ÙˆÚ˜Ù‡ ØµØ¯Ø§ÛŒ Ø±Ø§Ø¨ÛŒÙ† - Ø¯Ø³ØªÛŒØ§Ø± ØµÙˆØªÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯

ÛŒÚ© Ø¯Ø³ØªÛŒØ§Ø± ØµÙˆØªÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±ØŒ ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ ØµØ¯Ø§ØŒ Ùˆ ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ CRM.

---

## ğŸ“‹ ÙÙ‡Ø±Ø³Øª

- [Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡](#-Ø¯Ø±Ø¨Ø§Ø±Ù‡-Ù¾Ø±ÙˆÚ˜Ù‡)
- [ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§](#-ÙˆÛŒÚ˜Ú¯ÛŒÙ‡Ø§)
- [Ù…Ø¹Ù…Ø§Ø±ÛŒ](#-Ù…Ø¹Ù…Ø§Ø±ÛŒ)
- [Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ](#-Ù†ØµØ¨-Ùˆ-Ø±Ø§Ù‡Ø§Ù†Ø¯Ø§Ø²ÛŒ)
- [ØªØ³Øª](#-ØªØ³Øª)
- [Deploy](#-deploy)
- [Ù…Ø³ØªÙ†Ø¯Ø§Øª](#-Ù…Ø³ØªÙ†Ø¯Ø§Øª)
- [Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ](#-Ø¹ÛŒØ¨ÛŒØ§Ø¨ÛŒ)

---

## ğŸ¯ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡

**ØµØ¯Ø§ÛŒ Ø±Ø§Ø¨ÛŒÙ†** ÛŒÚ© Ø¯Ø³ØªÛŒØ§Ø± ØµÙˆØªÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø§Ø³Øª Ú©Ù‡:
- ğŸ¤ Ú¯ÙØªØ§Ø± Ø´Ù…Ø§ Ø±Ø§ ØªØ´Ø®ÛŒØµ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
- ğŸ¤– Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾Ø§Ø³Ø® Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
- ğŸ”Š Ù¾Ø§Ø³Ø® Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª ØµÙˆØªÛŒ Ù¾Ø®Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- ğŸ’¾ Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ CRM ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡ Ø§Ø³Øª

---

## âœ¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§

### ğŸ¤ ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø±
- ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± ÙØ§Ø±Ø³ÛŒ
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ
- ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø§ÛŒØ§Ù† Ø¬Ù…Ù„Ù‡

### ğŸ¤– Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
- ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¨Ø§ OpenRouter
- Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Claude 3 Haiku
- Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ Ù…ØªÙ†Ø§Ø³Ø¨

### ğŸ”Š ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ ØµØ¯Ø§ (TTS)
- ØµØ¯Ø§ÛŒ Ø·Ø¨ÛŒØ¹ÛŒ ÙØ§Ø±Ø³ÛŒ
- Ù¾Ø®Ø´ Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§
- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ

### ğŸ’¾ ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
- Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
- Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø´ØªØ±ÛŒØ§Ù†
- Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´
- Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ¸Ø§ÛŒÙ Ùˆ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§

---

## ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÛŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT                              â”‚
â”‚                    (React + Next.js)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Next.js API Routes â”‚
         â”‚   (Port 3001)        â”‚
         â”‚                      â”‚
         â”‚  /rabin-voice/api/   â”‚
         â”‚  â”œâ”€ ai               â”‚  â†’ OpenRouter (Claude 3)
         â”‚  â”œâ”€ tts              â”‚  â†’ TTS API
         â”‚  â”œâ”€ audio-proxy      â”‚  â†’ Audio Streaming
         â”‚  â””â”€ database         â”‚  â†’ MySQL Database
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒâ€ŒÙ‡Ø§:
- **Frontend:** Next.js 14, React 18, TypeScript
- **Backend:** Next.js API Routes
- **Database:** MySQL 8.0
- **AI:** OpenRouter (Claude 3 Haiku)
- **TTS:** Custom Persian TTS API
- **Deployment:** Docker, Nginx

---

## ğŸš€ Ù†ØµØ¨ Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ

### Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²Ù‡Ø§:
- Node.js 18+
- Docker & Docker Compose
- MySQL 8.0

### 1. Clone Repository
```bash
git clone <repository-url>
cd rabin-last
```

### 2. ØªÙ†Ø¸ÛŒÙ… Environment Variables
```bash
cd "ØµØ¯Ø§ÛŒ Ø±Ø§Ø¨ÛŒÙ†"
cp .env.example .env
nano .env
```

```bash
# .env
OPENROUTER_API_KEY=your-api-key
OPENROUTER_MODEL=anthropic/claude-3-haiku
TTS_API_URL=https://api.ahmadreza-avandi.ir/text-to-speech
PORT=3001
LOG_LEVEL=INFO

# Database (optional - move from lib/database.ts)
DB_HOST=your-db-host
DB_NAME=crm_system
DB_USER=your-db-user
DB_PASSWORD=your-db-password
```

### 3. Ù†ØµØ¨ Dependencies
```bash
npm install
```

### 4. Build Ùˆ Run
```bash
# Development
npm run dev

# Production
npm run build
npm start
```

### 5. Docker Deployment
```bash
# Build and start
./rebuild-rabin-voice.sh --clean --restart-nginx

# Test
./test-endpoints.sh
```

---

## ğŸ§ª ØªØ³Øª

### ØªØ³Øª Ø³Ø±ÛŒØ¹ TTS:
```bash
chmod +x test-tts-quick.sh
./test-tts-quick.sh
```

### ØªØ³Øª Ú©Ø§Ù…Ù„ Ø§ØªØµØ§Ù„:
```bash
chmod +x test-tts-connection.sh
./test-tts-connection.sh
```

### ØªØ³Øª Ù‡Ù…Ù‡ Endpointâ€ŒÙ‡Ø§:
```bash
chmod +x test-endpoints.sh
./test-endpoints.sh
```

### ØªØ³Øª Production:
```bash
./test-tts-quick.sh --prod
```

Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±: [TESTING-GUIDE.md](./TESTING-GUIDE.md)

---

## ğŸš¢ Deploy

### Ù…Ø±Ø§Ø­Ù„ Deploy:

1. **Rebuild Container:**
   ```bash
   ./rebuild-rabin-voice.sh --clean --restart-nginx
   ```

2. **Test Endpoints:**
   ```bash
   ./test-endpoints.sh
   ```

3. **Monitor Logs:**
   ```bash
   docker logs -f crm_rabin_voice
   ```

4. **Test Production:**
   ```bash
   ./test-tts-quick.sh --prod
   ```

Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±: [DEPLOYMENT-CHECKLIST.md](./DEPLOYMENT-CHECKLIST.md)

---

## ğŸ“š Ù…Ø³ØªÙ†Ø¯Ø§Øª

### Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§ØµÙ„ÛŒ:
- **[FINAL-SUMMARY.md](./FINAL-SUMMARY.md)** - Ø®Ù„Ø§ØµÙ‡ Ù†Ù‡Ø§ÛŒÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
- **[ARCHITECTURE-ANALYSIS.md](./ARCHITECTURE-ANALYSIS.md)** - Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ø§Ù…Ù„
- **[TESTING-GUIDE.md](./TESTING-GUIDE.md)** - Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªØ³Øª
- **[DEPLOYMENT-CHECKLIST.md](./DEPLOYMENT-CHECKLIST.md)** - Ú†Ú©â€ŒÙ„ÛŒØ³Øª deploy

### Ù…Ø³ØªÙ†Ø¯Ø§Øª ØªØºÛŒÛŒØ±Ø§Øª:
- **[FIXES-SUMMARY.md](./FIXES-SUMMARY.md)** - Ø®Ù„Ø§ØµÙ‡ ØªØºÛŒÛŒØ±Ø§Øª Ùˆ Ø±ÙØ¹ Ù…Ø´Ú©Ù„Ø§Øª

### Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙÙ†ÛŒ:
- **[DATABASE_INTEGRATION.md](./ØµØ¯Ø§ÛŒ Ø±Ø§Ø¨ÛŒÙ†/DATABASE_INTEGRATION.md)** - ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³

---

## ğŸ› Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### Ù…Ø´Ú©Ù„: TTS Ú©Ø§Ø± Ù†Ù…ÛŒâ€ŒÚ©Ù†Ù‡
```bash
# ØªØ³Øª Ø§ØªØµØ§Ù„
./test-tts-connection.sh

# Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§
docker logs --tail=100 crm_rabin_voice | grep TTS
```

### Ù…Ø´Ú©Ù„: Container start Ù†Ù…ÛŒâ€ŒØ´Ù‡
```bash
# Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§
docker-compose logs --tail=50 rabin-voice

# Rebuild
./rebuild-rabin-voice.sh --clean
```

### Ù…Ø´Ú©Ù„: 404 Not Found
```bash
# Ø¨Ø±Ø±Ø³ÛŒ nginx
docker-compose restart nginx

# Ø¨Ø±Ø±Ø³ÛŒ basePath
grep basePath "ØµØ¯Ø§ÛŒ Ø±Ø§Ø¨ÛŒÙ†/next.config.js"
```

Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±: [TESTING-GUIDE.md](./TESTING-GUIDE.md#-Ø¹ÛŒØ¨ÛŒØ§Ø¨ÛŒ)

---

## ğŸ“Š API Endpoints

| Endpoint | Method | Description | Status |
|----------|--------|-------------|--------|
| `/rabin-voice/api/ai` | POST | AI conversation | âœ… |
| `/rabin-voice/api/tts` | POST | Text-to-Speech | âœ… |
| `/rabin-voice/api/audio-proxy` | GET | Audio proxy | âœ… |
| `/rabin-voice/api/database` | POST | Database queries | âœ… |

### Ù…Ø«Ø§Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:

#### TTS:
```bash
curl -X POST http://localhost:3001/rabin-voice/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text":"Ø³Ù„Ø§Ù…"}'
```

#### AI:
```bash
curl -X POST http://localhost:3001/rabin-voice/api/ai \
  -H "Content-Type: application/json" \
  -d '{"message":"Ø³Ù„Ø§Ù… Ø±Ø§Ø¨ÛŒÙ†"}'
```

#### Database:
```bash
curl -X POST http://localhost:3001/rabin-voice/api/database \
  -H "Content-Type: application/json" \
  -d '{"action":"getEmployees"}'
```

---

## ğŸ”§ Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙÛŒØ¯

### ØªØ³Øª:
- `test-tts-quick.sh` - ØªØ³Øª Ø³Ø±ÛŒØ¹ TTS
- `test-tts-connection.sh` - ØªØ³Øª Ú©Ø§Ù…Ù„ Ø§ØªØµØ§Ù„
- `test-endpoints.sh` - ØªØ³Øª Ù‡Ù…Ù‡ endpointâ€ŒÙ‡Ø§
- `compare-implementations.sh` - Ù…Ù‚Ø§ÛŒØ³Ù‡ implementationâ€ŒÙ‡Ø§

### Deploy:
- `rebuild-rabin-voice.sh` - Rebuild Ú©Ø§Ù†ØªÛŒÙ†Ø±
- `quick-update.sh` - Update Ø³Ø±ÛŒØ¹ Ø¨Ø¯ÙˆÙ† rebuild

---

## ğŸ“ˆ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡

### âœ… Ú©Ø§Ù…Ù„ Ø´Ø¯Ù‡:
- [x] ØªØ´Ø®ÛŒØµ Ú¯ÙØªØ§Ø± ÙØ§Ø±Ø³ÛŒ
- [x] ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¨Ø§ AI
- [x] ØªØ¨Ø¯ÛŒÙ„ Ù…ØªÙ† Ø¨Ù‡ ØµØ¯Ø§
- [x] ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
- [x] Audio proxy
- [x] Docker deployment
- [x] Ù…Ø³ØªÙ†Ø¯Ø§Øª Ú©Ø§Ù…Ù„
- [x] Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ ØªØ³Øª

### ğŸš§ Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡:
- [ ] Caching mechanism
- [ ] Retry mechanism
- [ ] Monitoring/Metrics
- [ ] Rate limiting

### ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡Ø¨ÙˆØ¯:
- [ ] Ø­Ø°Ù Express.js (Legacy)
- [ ] Ø§Ù†ØªÙ‚Ø§Ù„ DB credentials Ø¨Ù‡ .env
- [ ] Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† CORS
- [ ] Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† unit tests

---

## ğŸ” Ø§Ù…Ù†ÛŒØª

### âš ï¸ Ù†Ú©Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ:
1. API keys Ø¯Ø± `.env` Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ âœ…
2. Database credentials Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ `.env` Ù…Ù†ØªÙ‚Ù„ Ø´ÙˆÙ†Ø¯ âš ï¸
3. CORS Ø¨Ø§ÛŒØ¯ Ù…Ø­Ø¯ÙˆØ¯ Ø´ÙˆØ¯ âš ï¸
4. `.env` Ø¯Ø± `.gitignore` Ø§Ø³Øª âœ…

---

## ğŸ“ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ

### Ø¯Ø³ØªÙˆØ±Ø§Øª Ù…ÙÛŒØ¯:

```bash
# Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø§Ú¯â€ŒÙ‡Ø§
docker logs -f crm_rabin_voice

# ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú©Ø§Ù†ØªÛŒÙ†Ø±
docker exec -it crm_rabin_voice sh

# Restart
docker-compose restart rabin-voice

# Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª
docker ps | grep rabin
```

---

## ğŸ¤ Ù…Ø´Ø§Ø±Ú©Øª

Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ø±Ú©Øª Ø¯Ø± Ù¾Ø±ÙˆÚ˜Ù‡:
1. Fork Ú©Ù†ÛŒØ¯
2. Branch Ø¬Ø¯ÛŒØ¯ Ø¨Ø³Ø§Ø²ÛŒØ¯
3. ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ commit Ú©Ù†ÛŒØ¯
4. Push Ú©Ù†ÛŒØ¯
5. Pull Request Ø¨Ø³Ø§Ø²ÛŒØ¯

---

## ğŸ“ Ù„Ø§ÛŒØ³Ù†Ø³

[Ù„Ø§ÛŒØ³Ù†Ø³ Ù¾Ø±ÙˆÚ˜Ù‡]

---

## ğŸ™ ØªØ´Ú©Ø±

Ø§Ø² Ù‡Ù…Ù‡ Ú©Ø³Ø§Ù†ÛŒ Ú©Ù‡ Ø¯Ø± ØªÙˆØ³Ø¹Ù‡ Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ù…Ø´Ø§Ø±Ú©Øª Ø¯Ø§Ø´ØªÙ†Ø¯ØŒ ØªØ´Ú©Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ….

---

## ğŸ“ ØªÙ…Ø§Ø³

- **Website:** https://crm.robintejarat.com/rabin-voice
- **Email:** [Ø§ÛŒÙ…ÛŒÙ„]
- **GitHub:** [Ù„ÛŒÙ†Ú© GitHub]

---

**Ù†Ø³Ø®Ù‡:** 1.0  
**Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ:** 2024  
**ÙˆØ¶Ø¹ÛŒØª:** âœ… Production Ready

---

**Ù…ÙˆÙÙ‚ Ø¨Ø§Ø´ÛŒØ¯! ğŸš€**

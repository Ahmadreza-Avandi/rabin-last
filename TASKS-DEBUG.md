# تشخیص مشکل هدایت به صفحه لاگین

## مراحل بررسی:

### 1. بررسی توکن بعد از لاگین
```
1. مرورگر را باز کنید (Chrome/Firefox)
2. F12 برای باز کردن Developer Tools
3. Console tab را باز کنید
4. `document.cookie` را تایپ کنید - باید `auth-token=...` و `tenant_token=...` را ببینید
5. `localStorage.getItem('auth-token')` را تایپ کنید - باید توکن را ببینید
```

### 2. شناسایی مشکل
اگر توکن نیست:
- صفحه لاگین را دوباره بارگذاری کنید
- **دقیقاً کنسول را هنگام لاگین بزنید**
- این پیغام‌ها را دنبال کنید:
  - `Login result:` - باید `success: true` و `token: "..."` را ببینید
  - `✅ Token stored in localStorage` - باید این پیغام را ببینید
  - `✅ Login successful` - باید این پیغام را ببینید

### 3. بررسی درخواست `/api/auth/me`
صفحه وظایف باید درخواست کند:
```
GET /api/auth/me
Headers: Authorization: Bearer <token>
```

اگر:
- **401 Unauthorized**: توکن نامعتبر است یا expire شده
- **500 Internal Server**: خطا در سرور
- معلومات کامل درخواست را در Console Network tab بررسی کنید

## نقاط مشکل احتمالی:

1. **توکن ذخیره نمی‌شود**: بررسی کنید که پاسخ لاگین توکن دارد
2. **توکن موجود نیست**: بررسی کنید `getAuthToken()` کار می‌کند
3. **توکن نامعتبر است**: بررسی کنید توکن صحیح ایجاد می‌شود
4. **Cookies تنظیم نمی‌شود**: بررسی کنید `auth-token` و `tenant_token` ظاهر می‌شود

## اسکریپت خودکار تست

من یک اسکریپت ایجاد می‌کنم که تمام اینها را خودکار بررسی کند.